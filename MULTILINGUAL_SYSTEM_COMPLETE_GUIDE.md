# å¤šè¯­è¨€ç¡¬ç¼–ç æ–‡æœ¬æ£€æµ‹å’Œæ›¿æ¢ç³»ç»Ÿå®Œæ•´æŒ‡å—

## ğŸŒŸ ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»Ÿä¸“ä¸ºFlutteré¡¹ç›®è®¾è®¡ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å’Œæ›¿æ¢ä»£ç ä¸­çš„ä¸­è‹±æ–‡ç¡¬ç¼–ç æ–‡æœ¬ï¼Œæ”¯æŒARBé”®å¤ç”¨ã€æ™ºèƒ½å‘½åã€å¹¶æä¾›å®Œæ•´çš„å®¡æ ¸å’Œæ›¿æ¢æµç¨‹ã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- **åŒè¯­è¨€æ”¯æŒ**ï¼šåŒæ—¶æ£€æµ‹ä¸­æ–‡å’Œè‹±æ–‡ç¡¬ç¼–ç æ–‡æœ¬
- **é«˜è¦†ç›–ç‡æ£€æµ‹**ï¼šæ”¯æŒTextã€hintTextã€labelTextã€tooltipã€å¯¹è¯æ¡†ã€æŒ‰é’®ç­‰å¤šç§UIåœºæ™¯
- **æ™ºèƒ½é”®å¤ç”¨**ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶å¤ç”¨ç°æœ‰ARBé”®ï¼Œé¿å…é‡å¤ç¿»è¯‘
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥å‘½å**ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„å’Œæ¨¡å—ç”Ÿæˆç¬¦åˆé¡¹ç›®ä¹ æƒ¯çš„é”®å
- **å®Œæ•´å·¥ä½œæµç¨‹**ï¼šä»æ£€æµ‹ã€å®¡æ ¸åˆ°æ›¿æ¢çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ
- **å®‰å…¨å¯æ§**ï¼šæ”¯æŒå¹²è¿è¡Œæ¨¡å¼ï¼Œæ‰€æœ‰æ›´æ”¹éƒ½å¯é¢„è§ˆå’Œæ’¤é”€

## ğŸ“ ç³»ç»Ÿæ–‡ä»¶ç»“æ„

```
demo/
â”œâ”€â”€ multilingual_hardcoded_detector.py    # ä¸»æ£€æµ‹å™¨
â”œâ”€â”€ enhanced_arb_applier.py               # ARBåº”ç”¨å™¨
â”œâ”€â”€ multilingual_detector_manager.bat     # ç®¡ç†è„šæœ¬
â”œâ”€â”€ multilingual_hardcoded_report/        # æŠ¥å‘Šç›®å½•
â”‚   â”œâ”€â”€ multilingual_summary_*.txt        # æ±‡æ€»æŠ¥å‘Š
â”‚   â”œâ”€â”€ multilingual_detail_*.txt         # è¯¦ç»†æŠ¥å‘Š
â”‚   â””â”€â”€ multilingual_mapping_*.yaml       # æ˜ å°„æ–‡ä»¶
â”œâ”€â”€ lib/l10n/
â”‚   â”œâ”€â”€ app_zh.arb                        # ä¸­æ–‡ARBæ–‡ä»¶
â”‚   â””â”€â”€ app_en.arb                        # è‹±æ–‡ARBæ–‡ä»¶
â””â”€â”€ lib/                                  # æºä»£ç ç›®å½•
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œæ£€æµ‹

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç®¡ç†è„šæœ¬ï¼ˆæ¨èï¼‰**
```bash
./multilingual_detector_manager.bat
```
é€‰æ‹©é€‰é¡¹ `[1] æ£€æµ‹ä¸­è‹±æ–‡ç¡¬ç¼–ç æ–‡æœ¬`

**æ–¹æ³•äºŒï¼šç›´æ¥å‘½ä»¤è¡Œ**
```bash
python multilingual_hardcoded_detector.py --mode both --output-format yaml
```

### 2. æŸ¥çœ‹æ£€æµ‹ç»“æœ

æ£€æµ‹å®Œæˆåä¼šç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶ï¼š
- `multilingual_summary_*.txt` - æ±‡æ€»æŠ¥å‘Š
- `multilingual_detail_*.txt` - è¯¦ç»†æŠ¥å‘Š  
- `multilingual_mapping_*.yaml` - æ˜ å°„æ–‡ä»¶

### 3. å®¡æ ¸æ˜ å°„æ–‡ä»¶

æ‰“å¼€ç”Ÿæˆçš„YAMLæ˜ å°„æ–‡ä»¶ï¼Œæ£€æŸ¥å¹¶ä¿®æ”¹ï¼š

```yaml
# ç¤ºä¾‹æ˜ å°„æ¡ç›®
- homePageTitle:
    text_en: "Home Page"              # è‹±æ–‡åŸæ–‡
    text_zh: "é¦–é¡µ"                   # ä¿®æ”¹ä¸ºåˆé€‚çš„ä¸­æ–‡ç¿»è¯‘
    file: presentation/pages/home_page.dart
    line: 13
    action: create_new                # create_new æˆ– reuse_existing
    approved: true                    # æ”¹ä¸º true è¡¨ç¤ºå®¡æ ¸é€šè¿‡
```

### 4. åº”ç”¨æ›¿æ¢

```bash
python enhanced_arb_applier.py --input multilingual_hardcoded_report/multilingual_mapping_*.yaml --dry-run
```

ç¡®è®¤æ— è¯¯åç§»é™¤ `--dry-run` å‚æ•°æ­£å¼åº”ç”¨ã€‚

## ğŸ” æ£€æµ‹èƒ½åŠ›è¯¦è§£

### æ”¯æŒçš„ä¸­æ–‡æ£€æµ‹åœºæ™¯

- **Text Widget**: `Text('ä¸­æ–‡æ–‡æœ¬')`
- **UIå±æ€§**: `hintText: 'è¯·è¾“å…¥', labelText: 'æ ‡ç­¾', tooltip: 'æç¤º'`
- **æŒ‰é’®**: `ElevatedButton(child: Text('æŒ‰é’®'))`
- **å¯¹è¯æ¡†**: `AlertDialog(title: Text('æ ‡é¢˜'), content: Text('å†…å®¹'))`
- **åº”ç”¨æ **: `AppBar(title: Text('æ ‡é¢˜'))`
- **åˆ—è¡¨**: `ListTile(title: Text('æ ‡é¢˜'))`

### æ”¯æŒçš„è‹±æ–‡æ£€æµ‹åœºæ™¯

- **Text Widget**: `Text('Home Page')`, `const Text('Cancel')`
- **UIå±æ€§**: `tooltip: 'Edit Tags', hintText: 'Enter text'`
- **æŒ‰é’®**: `child: Text('Save'), label: Text('Submit')`
- **å¯¹è¯æ¡†**: `AlertDialog(title: Text('Confirm'))`
- **å¯¼èˆª**: `BottomNavigationBarItem(label: 'Home')`

### æ™ºèƒ½è¿‡æ»¤æœºåˆ¶

ç³»ç»Ÿä¼šè‡ªåŠ¨æ’é™¤ä»¥ä¸‹å†…å®¹ï¼Œé¿å…è¯¯æ£€ï¼š
- æ³¨é‡Šä¸­çš„æ–‡æœ¬
- å¯¼å…¥è¯­å¥å’ŒåŒ…å
- è°ƒè¯•å’Œæ—¥å¿—è¯­å¥
- æŠ€æœ¯æœ¯è¯­å’Œç¼–ç¨‹å…³é”®è¯
- å•å­—æ¯æˆ–è¿‡çŸ­çš„æ–‡æœ¬
- URLå’Œæ–‡ä»¶è·¯å¾„

## ğŸ¯ ARBé”®å¤ç”¨ç­–ç•¥

### ç›¸ä¼¼åº¦ç®—æ³•

ç³»ç»Ÿä½¿ç”¨å­—ç¬¦ä¸²ç›¸ä¼¼åº¦ç®—æ³•æ£€æµ‹å¯å¤ç”¨çš„ARBé”®ï¼š
- **ç›¸ä¼¼åº¦ â‰¥ 0.9**: è‡ªåŠ¨å¤ç”¨ï¼Œæ ‡è®°ä¸ºå·²å®¡æ ¸
- **0.8 â‰¤ ç›¸ä¼¼åº¦ < 0.9**: å»ºè®®å¤ç”¨ï¼Œéœ€äººå·¥ç¡®è®¤
- **ç›¸ä¼¼åº¦ < 0.8**: åˆ›å»ºæ–°é”®

### å¤ç”¨ç¤ºä¾‹

```yaml
# è‹±æ–‡æ–‡æœ¬ "Cancel" è‡ªåŠ¨å¤ç”¨ç°æœ‰é”®
- cancel:
    text_en: "Cancel"
    text_zh: "å–æ¶ˆ"                   # è‡ªåŠ¨è·å–ç°æœ‰ä¸­æ–‡ç¿»è¯‘
    action: reuse_existing
    similarity: 1.0
    approved: true                    # è‡ªåŠ¨æ ‡è®°ä¸ºå·²å®¡æ ¸

# è‹±æ–‡æ–‡æœ¬ "Element" å¤ç”¨ç›¸ä¼¼é”® "elements"
- elements:
    text_en: "Element"
    text_zh: "å…ƒç´ "
    action: reuse_existing
    similarity: 0.93
    approved: true
```

## ğŸ—ï¸ é”®åç”Ÿæˆè§„åˆ™

### ä¸­æ–‡é”®åç”Ÿæˆ

- **æå–ä¸­æ–‡å­—ç¬¦**ï¼šæå–æ–‡æœ¬ä¸­çš„ä¸­æ–‡éƒ¨åˆ†
- **é•¿åº¦é™åˆ¶**ï¼šæˆªå–å‰8ä¸ªå­—ç¬¦
- **æ¨¡å—å‰ç¼€**ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„æ·»åŠ æ¨¡å—å‰ç¼€

```
æ–‡ä»¶ï¼šlib/presentation/pages/home/home_page.dart
æ–‡æœ¬ï¼šé¦–é¡µ
ç”Ÿæˆï¼šhomeé¦–é¡µ
```

### è‹±æ–‡é”®åç”Ÿæˆ

- **é©¼å³°å‘½å**ï¼šé¦–ä¸ªå•è¯å°å†™ï¼Œåç»­å•è¯é¦–å­—æ¯å¤§å†™
- **é•¿åº¦é™åˆ¶**ï¼šæœ€å¤š4ä¸ªå•è¯
- **æ¨¡å—å‰ç¼€**ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„æ·»åŠ æ¨¡å—å‰ç¼€

```
æ–‡ä»¶ï¼šlib/presentation/widgets/common/button.dart
æ–‡æœ¬ï¼šSave Changes
ç”Ÿæˆï¼šwidgetSaveChanges
```

### å†²çªå¤„ç†

å½“ç”Ÿæˆçš„é”®åå·²å­˜åœ¨æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ æ•°å­—åç¼€ï¼š
```
homeTitle â†’ homeTitle1 â†’ homeTitle2 ...
```

## ğŸ“Š æ£€æµ‹æŠ¥å‘Šè¯¦è§£

### æ±‡æ€»æŠ¥å‘Šç¤ºä¾‹

```
=== å¤šè¯­è¨€ç¡¬ç¼–ç æ–‡æœ¬æ£€æµ‹æ±‡æ€»æŠ¥å‘Š ===
æ£€æµ‹æ—¶é—´: 2025-06-17 03:18:19

=== ä¸­æ–‡ç¡¬ç¼–ç æ£€æµ‹ç»“æœ ===
æ£€æµ‹æ€»æ•°: 36
å¤ç”¨ARBé”®: 9
æ–°å»ºé”®: 27

ä¸­æ–‡ç¡¬ç¼–ç æŒ‰ç±»å‹åˆ†å¸ƒ:
  - ui_properties: 13
  - ui_text_widget: 20
  - ui_appbar_navigation: 3

=== è‹±æ–‡ç¡¬ç¼–ç æ£€æµ‹ç»“æœ ===
æ£€æµ‹æ€»æ•°: 57
å¤ç”¨ARBé”®: 21
æ–°å»ºé”®: 36

è‹±æ–‡ç¡¬ç¼–ç æŒ‰ç±»å‹åˆ†å¸ƒ:
  - ui_text_widget: 24
  - ui_appbar_navigation: 12
  - ui_buttons_labels: 14
  - ui_properties: 7

=== æ€»ä½“ç»Ÿè®¡ ===
ç¡¬ç¼–ç æ–‡æœ¬æ€»æ•°: 93
ARBé”®å¤ç”¨æ€»æ•°: 30
æ–°å»ºé”®æ€»æ•°: 63
```

### è¯¦ç»†æŠ¥å‘Šç¤ºä¾‹

```
--- UI_TEXT_WIDGET (24 ä¸ª) ---
æ–‡ä»¶: presentation/pages/home_page.dart, è¡Œ: 13
æ–‡æœ¬: "Home Page"
å»ºè®®é”®: home_page.dartHomepage
æ“ä½œ: åˆ›å»ºæ–°é”®

æ–‡ä»¶: presentation/pages/practices/widgets/practice_title_edit_dialog.dart, è¡Œ: 53
æ–‡æœ¬: "Cancel"
å¤ç”¨é”®: cancel (ç›¸ä¼¼åº¦: 1.00)
æ“ä½œ: å¤ç”¨ç°æœ‰é”®
```

## âš™ï¸ é«˜çº§é…ç½®

### è‡ªå®šä¹‰æ£€æµ‹æ¨¡å¼

```bash
# åªæ£€æµ‹ä¸­æ–‡
python multilingual_hardcoded_detector.py --mode chinese

# åªæ£€æµ‹è‹±æ–‡  
python multilingual_hardcoded_detector.py --mode english

# æ£€æµ‹å…¨éƒ¨ï¼ˆé»˜è®¤ï¼‰
python multilingual_hardcoded_detector.py --mode both
```

### è¾“å‡ºæ ¼å¼é€‰é¡¹

```bash
# YAMLæ ¼å¼ï¼ˆæ¨èï¼Œç”¨äºåç»­å¤„ç†ï¼‰
python multilingual_hardcoded_detector.py --output-format yaml

# JSONæ ¼å¼
python multilingual_hardcoded_detector.py --output-format json

# çº¯æ–‡æœ¬æ ¼å¼
python multilingual_hardcoded_detector.py --output-format text
```

### æ’é™¤ç‰¹å®šæ–‡ä»¶

ç¼–è¾‘æ£€æµ‹å™¨è„šæœ¬ï¼Œåœ¨`CODE_DIR`å¸¸é‡é™„è¿‘æ·»åŠ æ’é™¤æ¨¡å¼ï¼š

```python
EXCLUDED_PATHS = [
    '**/test/**',
    '**/generated/**',
    '**/build/**'
]
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ­£åˆ™è¡¨è¾¾å¼é”™è¯¯**
   ```
   Error: unterminated character set at position 10
   ```
   **è§£å†³æ–¹æ³•**ï¼šç¡®ä¿æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„å­—ç¬¦ç±»æ­£ç¡®é—­åˆï¼Œæ£€æŸ¥æ–¹æ‹¬å·é…å¯¹ã€‚

2. **ç¼–ç é”™è¯¯**
   ```
   UnicodeDecodeError: 'utf-8' codec can't decode byte
   ```
   **è§£å†³æ–¹æ³•**ï¼šç¡®ä¿æ‰€æœ‰Dartæ–‡ä»¶éƒ½æ˜¯UTF-8ç¼–ç ã€‚

3. **ARBæ–‡ä»¶ä¸å­˜åœ¨**
   ```
   FileNotFoundError: [Errno 2] No such file or directory: 'lib/l10n/app_zh.arb'
   ```
   **è§£å†³æ–¹æ³•**ï¼šç¡®ä¿ARBæ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼Œæˆ–ä¿®æ”¹æ£€æµ‹å™¨ä¸­çš„ARBæ–‡ä»¶è·¯å¾„é…ç½®ã€‚

### è°ƒè¯•æ¨¡å¼

ä¸ºæ£€æµ‹å™¨æ·»åŠ è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼š

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### æ€§èƒ½ä¼˜åŒ–

å¯¹äºå¤§å‹é¡¹ç›®ï¼Œå¯ä»¥ï¼š
1. é™åˆ¶æ£€æµ‹çš„æ–‡ä»¶èŒƒå›´
2. ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†
3. ç¼“å­˜ARBæ–‡ä»¶å†…å®¹

## ğŸ“ æœ€ä½³å®è·µ

### 1. å®šæœŸæ£€æµ‹

å»ºè®®åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®šæœŸè¿è¡Œæ£€æµ‹ï¼š
- æ¯æ—¥æ„å»ºæ—¶è‡ªåŠ¨æ£€æµ‹
- ä»£ç æäº¤å‰æ‰‹åŠ¨æ£€æµ‹
- å‘å¸ƒå‰å®Œæ•´æ£€æµ‹

### 2. å›¢é˜Ÿåä½œ

- æŒ‡å®šä¸“äººè´Ÿè´£å®¡æ ¸æ˜ å°„æ–‡ä»¶
- å»ºç«‹ç¿»è¯‘è´¨é‡æ ‡å‡†
- ç»´æŠ¤é¡¹ç›®ä¸“ç”¨æœ¯è¯­è¡¨

### 3. è´¨é‡æ§åˆ¶

- å®¡æ ¸æ‰€æœ‰æ–°å»ºçš„ARBé”®å
- éªŒè¯ç¿»è¯‘çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§
- æµ‹è¯•æ›¿æ¢åçš„UIæ•ˆæœ

### 4. å¤‡ä»½ç­–ç•¥

- åº”ç”¨æ›¿æ¢å‰å¤‡ä»½åŸå§‹æ–‡ä»¶
- ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶è·Ÿè¸ªæ‰€æœ‰æ›´æ”¹
- ä¿ç•™æ£€æµ‹æŠ¥å‘Šç”¨äºå†å²è¿½æº¯

## ğŸ”„ æŒç»­æ”¹è¿›

### æ‰©å±•æ£€æµ‹åœºæ™¯

æ ¹æ®é¡¹ç›®éœ€è¦ï¼Œå¯ä»¥æ·»åŠ æ–°çš„æ£€æµ‹æ¨¡å¼ï¼š

```python
# æ·»åŠ æ–°çš„æ£€æµ‹æ¨¡å¼åˆ° ENGLISH_PATTERNS æˆ– CHINESE_PATTERNS
"ui_forms": [
    r'FormField.*?labelText:\s*[\'\"](.*?)[\'\"]',
    r'TextFormField.*?hintText:\s*[\'\"](.*?)[\'\"]',
]
```

### ä¼˜åŒ–é”®åç”Ÿæˆ

æ ¹æ®é¡¹ç›®å‘½åä¹ æƒ¯è°ƒæ•´é”®åç”Ÿæˆç®—æ³•ï¼š

```python
def generate_custom_key(self, text, context, file_path, language):
    # è‡ªå®šä¹‰é”®åç”Ÿæˆé€»è¾‘
    pass
```

### é›†æˆCI/CD

å°†æ£€æµ‹è¿‡ç¨‹é›†æˆåˆ°æŒç»­é›†æˆæµç¨‹ï¼š

```yaml
# GitHub Actions ç¤ºä¾‹
- name: Detect Hardcoded Text
  run: |
    python multilingual_hardcoded_detector.py --mode both
    # æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„ç¡¬ç¼–ç æ–‡æœ¬
```

## ğŸ“ æ”¯æŒä¸åé¦ˆ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥ç›¸å…³çš„READMEæ–‡ä»¶
3. æäº¤issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

---

**ç³»ç»Ÿç‰ˆæœ¬**: 2.0  
**æœ€åæ›´æ–°**: 2025-06-17  
**æ”¯æŒè¯­è¨€**: ä¸­æ–‡ã€è‹±æ–‡  
**å…¼å®¹æ€§**: Flutter 3.0+, Dart 3.0+
