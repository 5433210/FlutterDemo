# å­—å¸–ç¼–è¾‘é¡µæ—¥å¿—ä¼˜åŒ–å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ¯ é—®é¢˜åˆ†æ

### å½“å‰é—®é¢˜
1. **æ—¥å¿—æ–¹æ³•ä¸ç»Ÿä¸€**ï¼šæ··ç”¨ `print`ã€`debugPrint`ã€`developer.log` ç­‰å¤šç§è¾“å‡ºæ–¹å¼
2. **æ—¥å¿—è¾“å‡ºç¹æ‚æ··ä¹±**ï¼šç¼ºä¹ç»Ÿä¸€çš„æ—¥å¿—çº§åˆ«å’Œåˆ†ç±»ç®¡ç†
3. **æ€§èƒ½å½±å“ä¸¥é‡**ï¼šè¿‡å¤šçš„æ—¥å¿—è¾“å‡ºæå¤§å½±å“åº”ç”¨æ€§èƒ½

### å½±å“èŒƒå›´
- å­—å¸–ç¼–è¾‘é¡µä¸»é¡µé¢ (`m3_practice_edit_page.dart`)
- ç”»å¸ƒç»„ä»¶ (`m3_practice_edit_canvas.dart`)
- æ§åˆ¶å™¨ (`practice_edit_controller.dart`)
- æ‰€æœ‰å±æ€§é¢æ¿ç»„ä»¶
- æ¸²æŸ“å™¨ç»„ä»¶
- å·¥å…·é¢æ¿ç»„ä»¶
- æ–‡ä»¶æ“ä½œç»„ä»¶

## ğŸš€ è§£å†³æ–¹æ¡ˆæ¶æ„

### 1. ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ
åŸºäºç°æœ‰çš„ `AppLogger` ç³»ç»Ÿï¼Œå®ç°ï¼š
- ç»Ÿä¸€çš„æ—¥å¿—æ¥å£
- åˆ†çº§æ—¥å¿—ç®¡ç†
- ç»„ä»¶åŒ–æ—¥å¿—æ ‡ç­¾
- å¯é…ç½®çš„æ—¥å¿—è¾“å‡º
- æ€§èƒ½ä¼˜åŒ–çš„æ—¥å¿—å¤„ç†

### 2. æ—¥å¿—åˆ†çº§ç­–ç•¥
```dart
// æ—¥å¿—çº§åˆ«ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰
enum LogLevel {
  fatal,    // è‡´å‘½é”™è¯¯ï¼Œåº”ç”¨å´©æºƒçº§åˆ«
  error,    // é”™è¯¯æ—¥å¿—ï¼Œå½±å“åŠŸèƒ½è¿è¡Œ
  warning,  // è­¦å‘Šæ—¥å¿—ï¼Œæ½œåœ¨é—®é¢˜
  info,     // ä¿¡æ¯æ—¥å¿—ï¼Œé‡è¦æ“ä½œè®°å½•
  debug,    // è°ƒè¯•æ—¥å¿—ï¼Œå¼€å‘è°ƒè¯•ä¿¡æ¯
}
```

### 3. ç»„ä»¶æ ‡ç­¾è§„èŒƒ
```dart
// å­—å¸–ç¼–è¾‘é¡µç»„ä»¶æ ‡ç­¾
const String TAG_EDIT_PAGE = 'EditPage';
const String TAG_CANVAS = 'Canvas';
const String TAG_CONTROLLER = 'Controller';
const String TAG_TEXT_PANEL = 'TextPanel';
const String TAG_IMAGE_PANEL = 'ImagePanel';
const String TAG_LAYER_PANEL = 'LayerPanel';
const String TAG_RENDERER = 'Renderer';
const String TAG_FILE_OPS = 'FileOps';
```

## ğŸ”§ å®æ–½æ–¹æ¡ˆ

### é˜¶æ®µä¸€ï¼šæ—¥å¿—ç³»ç»Ÿé…ç½®ä¼˜åŒ–

#### 1.1 åˆ›å»ºå­—å¸–ç¼–è¾‘é¡µä¸“ç”¨æ—¥å¿—é…ç½®
```dart
// lib/utils/config/edit_page_logging_config.dart
class EditPageLoggingConfig {
  // ä¸»ç¼–è¾‘é¡µé¢æ—¥å¿—æ§åˆ¶
  static bool enableEditPageLogging = true;
  static LogLevel editPageMinLevel = LogLevel.info;
  
  // ç”»å¸ƒæ¸²æŸ“æ—¥å¿—æ§åˆ¶
  static bool enableCanvasLogging = false;  // é»˜è®¤å…³é—­é«˜é¢‘æ—¥å¿—
  static LogLevel canvasMinLevel = LogLevel.error;
  
  // æ§åˆ¶å™¨æ—¥å¿—æ§åˆ¶
  static bool enableControllerLogging = true;
  static LogLevel controllerMinLevel = LogLevel.warning;
  
  // å±æ€§é¢æ¿æ—¥å¿—æ§åˆ¶
  static bool enablePropertyPanelLogging = false;
  static LogLevel propertyPanelMinLevel = LogLevel.error;
  
  // æ¸²æŸ“å™¨æ—¥å¿—æ§åˆ¶
  static bool enableRendererLogging = false;
  static LogLevel rendererMinLevel = LogLevel.error;
  
  // æ€§èƒ½ç›‘æ§æ—¥å¿—
  static bool enablePerformanceLogging = true;
  static LogLevel performanceMinLevel = LogLevel.info;
}
```

#### 1.2 æ‰©å±• AppLogger åŠŸèƒ½
```dart
// æ‰©å±• AppLogger ä»¥æ”¯æŒæ¡ä»¶æ—¥å¿—
extension EditPageLogger on AppLogger {
  static void editPageDebug(String message, {String? tag, Map<String, dynamic>? data}) {
    if (EditPageLoggingConfig.enableEditPageLogging && 
        LogLevel.debug.index >= EditPageLoggingConfig.editPageMinLevel.index) {
      AppLogger.debug(message, tag: tag ?? TAG_EDIT_PAGE, data: data);
    }
  }
  
  static void canvasDebug(String message, {String? tag, Map<String, dynamic>? data}) {
    if (EditPageLoggingConfig.enableCanvasLogging && 
        LogLevel.debug.index >= EditPageLoggingConfig.canvasMinLevel.index) {
      AppLogger.debug(message, tag: tag ?? TAG_CANVAS, data: data);
    }
  }
  
  static void performanceInfo(String message, {String? tag, Map<String, dynamic>? data}) {
    if (EditPageLoggingConfig.enablePerformanceLogging && 
        LogLevel.info.index >= EditPageLoggingConfig.performanceMinLevel.index) {
      AppLogger.info(message, tag: tag ?? 'Performance', data: data);
    }
  }
}
```

### é˜¶æ®µäºŒï¼šæ ¸å¿ƒç»„ä»¶æ—¥å¿—æ›¿æ¢

#### 2.1 ä¸»ç¼–è¾‘é¡µé¢ä¼˜åŒ– âœ… (å·²å®Œæˆ)
- [x] æ›¿æ¢æ‰€æœ‰ `debugPrint` ä¸º `AppLogger`
- [x] æ·»åŠ é¡µé¢ç”Ÿå‘½å‘¨æœŸæ—¥å¿—
- [x] æ·»åŠ å·¥å…·åˆ‡æ¢æ—¥å¿—
- [x] æ·»åŠ æ€§èƒ½å…³é”®ç‚¹æ—¥å¿—

#### 2.2 ç”»å¸ƒç»„ä»¶ä¼˜åŒ– (é«˜ä¼˜å…ˆçº§)
```dart
// ç¤ºä¾‹ï¼šç”»å¸ƒç»„ä»¶æ—¥å¿—ä¼˜åŒ–
class M3PracticeEditCanvas extends StatefulWidget {
  void _logCanvasOperation(String operation, {Map<String, dynamic>? data}) {
    // ä½¿ç”¨æ¡ä»¶æ—¥å¿—ï¼Œé¿å…æ€§èƒ½å½±å“
    if (EditPageLoggingConfig.enableCanvasLogging) {
      AppLogger.debug('ç”»å¸ƒæ“ä½œ: $operation', tag: TAG_CANVAS, data: data);
    }
  }
  
  void _logPerformanceMetric(String metric, int timeMs) {
    AppLogger.performanceInfo('æ¸²æŸ“æ€§èƒ½: $metric = ${timeMs}ms', 
        tag: TAG_CANVAS, data: {'metric': metric, 'time_ms': timeMs});
  }
}
```

#### 2.3 æ§åˆ¶å™¨ä¼˜åŒ– (é«˜ä¼˜å…ˆçº§)
```dart
// ç¤ºä¾‹ï¼šæ§åˆ¶å™¨æ—¥å¿—ä¼˜åŒ–
class PracticeEditController {
  void _logStateChange(String state, {Map<String, dynamic>? data}) {
    AppLogger.info('çŠ¶æ€å˜æ›´: $state', tag: TAG_CONTROLLER, data: data);
  }
  
  void _logError(String operation, Object error, {StackTrace? stackTrace}) {
    AppLogger.error('æ“ä½œå¤±è´¥: $operation', 
        tag: TAG_CONTROLLER, error: error, stackTrace: stackTrace);
  }
}
```

### é˜¶æ®µä¸‰ï¼šå±æ€§é¢æ¿ç»„ä»¶ä¼˜åŒ–

#### 3.1 æ–‡æœ¬å±æ€§é¢æ¿
- æ›¿æ¢ `developer.log` ä¸ºæ¡ä»¶æ—¥å¿—
- æ·»åŠ æ–‡æœ¬å†…å®¹å˜æ›´çš„æ€§èƒ½æ—¥å¿—
- ä¼˜åŒ–å­—ä½“è®¾ç½®å˜æ›´æ—¥å¿—

#### 3.2 é›†å­—å±æ€§é¢æ¿
- æ·»åŠ é›†å­—å†…å®¹å˜æ›´çš„æ‰¹é‡æ—¥å¿—
- ä¼˜åŒ–ç­›é€‰æ¡ä»¶å˜æ›´æ—¥å¿—
- æ·»åŠ é¢„è§ˆæ¸²æŸ“æ€§èƒ½ç›‘æ§

#### 3.3 å›¾ç‰‡å±æ€§é¢æ¿
- æ·»åŠ å›¾ç‰‡åŠ è½½æ€§èƒ½æ—¥å¿—
- ä¼˜åŒ–å›¾ç‰‡å˜æ¢æ“ä½œæ—¥å¿—
- æ·»åŠ æ»¤é•œåº”ç”¨æ€§èƒ½ç›‘æ§

#### 3.4 å›¾å±‚å±æ€§é¢æ¿
- æ·»åŠ å›¾å±‚æ“ä½œçš„æ‰¹é‡æ—¥å¿—
- ä¼˜åŒ–å›¾å±‚çŠ¶æ€å˜æ›´æ—¥å¿—
- æ·»åŠ å›¾å±‚æ¸²æŸ“æ€§èƒ½ç›‘æ§

### é˜¶æ®µå››ï¼šæ¸²æŸ“å™¨ç»„ä»¶ä¼˜åŒ–

#### 4.1 é›†å­—æ¸²æŸ“å™¨
```dart
// ç¤ºä¾‹ï¼šæ¸²æŸ“å™¨æ€§èƒ½æ—¥å¿—
class CollectionElementRenderer {
  void _logRenderPerformance(String operation, Stopwatch stopwatch) {
    final elapsedMs = stopwatch.elapsedMilliseconds;
    if (elapsedMs > 16) { // è¶…è¿‡ä¸€å¸§æ—¶é—´æ‰è®°å½•
      AppLogger.performanceInfo('æ¸²æŸ“è€—æ—¶: $operation = ${elapsedMs}ms', 
          tag: TAG_RENDERER, data: {'operation': operation, 'time_ms': elapsedMs});
    }
  }
}
```

#### 4.2 æ–‡æœ¬æ¸²æŸ“å™¨
- ä¼˜åŒ–æ–‡æœ¬æ¸²æŸ“æ€§èƒ½æ—¥å¿—
- æ·»åŠ å¸ƒå±€è®¡ç®—è€—æ—¶ç›‘æ§
- ä¼˜åŒ–å­—ä½“åŠ è½½æ—¥å¿—

#### 4.3 å›¾ç‰‡æ¸²æŸ“å™¨
- æ·»åŠ å›¾ç‰‡åŠ è½½æ€§èƒ½ç›‘æ§
- ä¼˜åŒ–å›¾ç‰‡å˜æ¢è€—æ—¶æ—¥å¿—
- æ·»åŠ å†…å­˜ä½¿ç”¨ç›‘æ§

## ğŸ›ï¸ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ¡ä»¶æ—¥å¿—è¾“å‡º
```dart
// ä½¿ç”¨å®æˆ–é…ç½®æ§åˆ¶æ—¥å¿—è¾“å‡º
if (kDebugMode && EditPageLoggingConfig.enableCanvasLogging) {
  AppLogger.debug(message, tag: TAG_CANVAS);
}
```

### 2. å¼‚æ­¥æ—¥å¿—å¤„ç†
```dart
// å¯¹äºå¤æ‚æ—¥å¿—æ•°æ®ï¼Œä½¿ç”¨å¼‚æ­¥å¤„ç†
Future<void> _logComplexData(Map<String, dynamic> data) async {
  compute(_processLogData, data).then((result) {
    AppLogger.info('å¤„ç†å®Œæˆ', tag: TAG_EDIT_PAGE, data: result);
  });
}
```

### 3. æ‰¹é‡æ—¥å¿—å¤„ç†
```dart
// å¯¹äºé«˜é¢‘æ“ä½œï¼Œä½¿ç”¨æ‰¹é‡æ—¥å¿—
class BatchLogger {
  static final List<LogEntry> _batch = [];
  static Timer? _timer;
  
  static void addToBatch(LogLevel level, String message, String tag) {
    _batch.add(LogEntry(level: level, message: message, tag: tag));
    
    _timer?.cancel();
    _timer = Timer(Duration(milliseconds: 100), _flushBatch);
  }
  
  static void _flushBatch() {
    if (_batch.isNotEmpty) {
      AppLogger.debug('æ‰¹é‡æ—¥å¿—: ${_batch.length}æ¡', tag: 'BatchLogger');
      _batch.clear();
    }
  }
}
```

### 4. æ—¥å¿—çº§åˆ«åŠ¨æ€æ§åˆ¶
```dart
// è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«
class LoggingController {
  static void setEditPageLogLevel(LogLevel level) {
    EditPageLoggingConfig.editPageMinLevel = level;
    AppLogger.info('æ—¥å¿—çº§åˆ«å·²è°ƒæ•´: $level', tag: 'LoggingController');
  }
  
  static void disableHighFrequencyLogs() {
    EditPageLoggingConfig.enableCanvasLogging = false;
    EditPageLoggingConfig.enablePropertyPanelLogging = false;
    AppLogger.info('å·²å…³é—­é«˜é¢‘æ—¥å¿—', tag: 'LoggingController');
  }
}
```

## ğŸ“Š å®æ–½è®¡åˆ’

### ç¬¬ä¸€å‘¨ï¼šæ ¸å¿ƒç»„ä»¶ä¼˜åŒ–
- [ ] å®Œå–„æ—¥å¿—é…ç½®ç³»ç»Ÿ
- [ ] ä¼˜åŒ–ç”»å¸ƒç»„ä»¶æ—¥å¿—
- [ ] ä¼˜åŒ–æ§åˆ¶å™¨æ—¥å¿—
- [ ] æ€§èƒ½åŸºçº¿æµ‹è¯•

### ç¬¬äºŒå‘¨ï¼šå±æ€§é¢æ¿ä¼˜åŒ–
- [ ] æ–‡æœ¬å±æ€§é¢æ¿æ—¥å¿—ä¼˜åŒ–
- [ ] é›†å­—å±æ€§é¢æ¿æ—¥å¿—ä¼˜åŒ–
- [ ] å›¾ç‰‡å±æ€§é¢æ¿æ—¥å¿—ä¼˜åŒ–
- [ ] å›¾å±‚å±æ€§é¢æ¿æ—¥å¿—ä¼˜åŒ–

### ç¬¬ä¸‰å‘¨ï¼šæ¸²æŸ“å™¨ä¼˜åŒ–
- [ ] é›†å­—æ¸²æŸ“å™¨æ—¥å¿—ä¼˜åŒ–
- [ ] æ–‡æœ¬æ¸²æŸ“å™¨æ—¥å¿—ä¼˜åŒ–
- [ ] å›¾ç‰‡æ¸²æŸ“å™¨æ—¥å¿—ä¼˜åŒ–
- [ ] æ¸²æŸ“æ€§èƒ½ç›‘æ§ç³»ç»Ÿ

### ç¬¬å››å‘¨ï¼šæµ‹è¯•ä¸ä¼˜åŒ–
- [ ] å…¨é¢æ€§èƒ½æµ‹è¯•
- [ ] æ—¥å¿—ç³»ç»Ÿå‹åŠ›æµ‹è¯•
- [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•
- [ ] æœ€ç»ˆä¼˜åŒ–è°ƒæ•´

## ğŸ§ª è´¨é‡ä¿è¯

### 1. æ€§èƒ½åŸºå‡†
- æ—¥å¿—è¾“å‡ºå»¶è¿Ÿ < 5ms
- å†…å­˜å ç”¨å¢é•¿ < 10MB
- ç•Œé¢å“åº”æ— æ˜æ˜¾å»¶è¿Ÿ
- åº”ç”¨å¯åŠ¨æ—¶é—´æ— å½±å“

### 2. åŠŸèƒ½éªŒè¯
- æ‰€æœ‰é”™è¯¯éƒ½æœ‰æ—¥å¿—è®°å½•
- å…³é”®æ“ä½œå¯å®Œæ•´è¿½è¸ª
- æ€§èƒ½é—®é¢˜å¯å‡†ç¡®å®šä½
- è°ƒè¯•ä¿¡æ¯æ¸…æ™°æœ‰ç”¨

### 3. ä»£ç è´¨é‡
- æ— ä¼ ç»Ÿæ—¥å¿—æ–¹æ³•æ®‹ç•™
- æ—¥å¿—æ ¼å¼ç»Ÿä¸€è§„èŒƒ
- ç»„ä»¶æ ‡ç­¾ä½¿ç”¨æ­£ç¡®
- æ—¥å¿—çº§åˆ«è®¾ç½®åˆç†

## ğŸ¯ é¢„æœŸæ•ˆæœ

### æ€§èƒ½æå‡
- åº”ç”¨å“åº”é€Ÿåº¦æå‡ 20-30%
- å†…å­˜ä½¿ç”¨æ›´åŠ ç¨³å®š
- æ¸²æŸ“æ€§èƒ½æ˜¾è‘—æ”¹å–„
- å¯åŠ¨æ—¶é—´åŸºæœ¬æ— å½±å“

### å¼€å‘æ•ˆç‡
- é—®é¢˜å®šä½é€Ÿåº¦æå‡ 50%
- è°ƒè¯•ä¿¡æ¯æ›´åŠ æ¸…æ™°
- é”™è¯¯è¿½è¸ªæ›´åŠ å‡†ç¡®
- æ€§èƒ½ä¼˜åŒ–æ›´æœ‰é’ˆå¯¹æ€§

### ç»´æŠ¤æ€§æ”¹å–„
- æ—¥å¿—ç³»ç»Ÿç»Ÿä¸€ç®¡ç†
- é…ç½®çµæ´»å¯è°ƒ
- ä»£ç ç»“æ„æ›´æ¸…æ™°
- æ‰©å±•æ€§æ›´å¥½

## ğŸ“ é…ç½®å»ºè®®

### å¼€å‘ç¯å¢ƒé…ç½®
```dart
// å¼€å‘ç¯å¢ƒï¼šè¯¦ç»†æ—¥å¿—
EditPageLoggingConfig.enableEditPageLogging = true;
EditPageLoggingConfig.editPageMinLevel = LogLevel.debug;
EditPageLoggingConfig.enablePerformanceLogging = true;
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®
```dart
// ç”Ÿäº§ç¯å¢ƒï¼šä»…å…³é”®æ—¥å¿—
EditPageLoggingConfig.enableEditPageLogging = true;
EditPageLoggingConfig.editPageMinLevel = LogLevel.warning;
EditPageLoggingConfig.enableCanvasLogging = false;
EditPageLoggingConfig.enablePropertyPanelLogging = false;
```

### æ€§èƒ½è°ƒè¯•é…ç½®
```dart
// æ€§èƒ½è°ƒè¯•ï¼šä¸“æ³¨æ€§èƒ½æ—¥å¿—
EditPageLoggingConfig.enablePerformanceLogging = true;
EditPageLoggingConfig.performanceMinLevel = LogLevel.info;
// å…¶ä»–æ—¥å¿—çº§åˆ«æé«˜åˆ° warning ä»¥ä¸Š
```

---

*è¯¥æ–¹æ¡ˆåŸºäºç°æœ‰çš„ AppLogger ç³»ç»Ÿè®¾è®¡ï¼Œç¡®ä¿ä¸é¡¹ç›®æ¶æ„å®Œå…¨å…¼å®¹ï¼ŒåŒæ—¶æœ€å¤§ç¨‹åº¦åœ°è§£å†³æ€§èƒ½é—®é¢˜å¹¶æå‡å¼€å‘æ•ˆç‡ã€‚* 