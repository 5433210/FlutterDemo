# 集字功能界面设计

## 主界面布局

集字功能的主界面采用分屏设计，左侧为图片预览区，右侧为标签页面板。

```text
+--------------------------------------------------------------+
| 导航栏 [返回] [集字功能] [帮助]          [最小化] [关闭]    |
+--------------------------------------------------------------+
|                          |                                    |
|      图片预览区          |         右侧面板（标签页）         |
|                          |  [集字效果预览] [作品集字结果]     |
| [✋] [□] [▣] [🗑️]       | +--------------------------------+ |
| +----------------------+ | |                                | |
| |                      | | |        内容区域                | |
| |      原始图片        | | |                                | |
| |                      | | |  * 标签页1: 集字效果预览       | |
| |    * 已保存框线      | | |    - 二值化显示                | |
| |    * 当前选择框      | | |    - 擦除区域                  | |
| |    * 缩放/平移       | | |    - 轮廓线显示                | |
| |                      | | |    - [工具栏]                  | |
| +----------------------+ | |  * 标签页2: 作品集字结果       | |
|                          | |    - 网格展示集字图片          | |
| 缩略图区域:              | |    - 点击跳转到对应字          | |
| [缩略图1][缩略图2]...    | |                                | |
|                          | +--------------------------------+ |
+--------------------------------------------------------------+
```

## 导航栏设计

导航栏包含以下元素：

- **返回按钮**：点击返回上一页面（作品详情页）
- **页面标题**：显示"集字功能"标题
- **帮助按钮**：点击显示集字功能操作指南弹窗
- **扩展菜单**（可选）：包含高级选项如导出、重置等

导航栏在不同状态下的变化：

- **未保存状态**：显示退出确认提示
- **批量操作状态**：显示选中数量和批量操作按钮
- **处理中状态**：显示进度指示器

### 导航栏样式与交互

- 背景色：主题色
- 高度：56dp
- 文字：白色，16sp
- 按钮：48x48dp点击区域
- 返回按钮：左对齐
- 标题：居中
- 帮助按钮：右对齐，带圆形波纹效果
- 状态提示：标题右侧，淡色文本

## 左侧图片预览区设计

### 工具栏

位于预览区顶部，包含以下工具按钮：

- **拖拽工具**：默认选中，用于平移和缩放图片
- **框选工具**：用于在图片中框选字符区域
- **多选工具**：用于选择多个已保存的字符框
- **删除按钮**：删除当前选中的字符框

### 图片显示区

- 支持缩放和平移操作
- 显示原始图片
- 已保存字符框用绿色线框标识
- 当前选中框用蓝色线框标识
- 新建框选时显示蓝色虚线框

#### 选中区域的调整控件

当一个区域被选中时（通过框选工具新建或多选工具选中已有区域），将显示以下调整控件：

- **调整手柄**：选框的四个角和四边中点显示小方块手柄，用于调整大小
  - 角部手柄：调整大小时保持对角线上的另一点固定
  - 边部手柄：只调整对应边的位置，保持其他三边固定
  - 手柄颜色为白色填充，蓝色边框，突出显示

- **旋转控件**：
  - 选框顶部中央上方显示一个圆形旋转控制点
  - 从选框中心到旋转控制点有一条虚线连接
  - 鼠标悬停在旋转控制点上时，光标变为旋转光标

- **移动区域**：
  - 选框内部可直接拖动移动整个选框
  - 拖动时显示半透明的位置指示线

#### 选区调整的视觉反馈

- **尺寸指示器**：调整大小时，在选框附近显示当前尺寸（宽x高）
- **角度指示器**：旋转时，显示当前旋转角度值
- **对齐辅助线**：接近水平/垂直位置时显示红色辅助线辅助对齐
- **调整过程中**：选框显示为动态虚线，以区分固定状态

#### 精确调整选项

- **微调按钮**：选中状态下，右侧面板显示数值微调控件
  - X/Y坐标微调按钮（±1px）
  - 宽/高微调按钮（±1px）
  - 角度微调按钮（±1°）
- **键盘快捷键**：
  - 方向键：移动选框（1px）
  - Shift+方向键：调整大小（1px）
  - Ctrl+方向键：旋转（1°）

### 缩略图区域

- 位于预览区底部
- 水平滚动显示所有页面的缩略图
- 当前页面高亮显示
- 点击缩略图可快速切换页面

## 右侧面板设计

### 标签页设计

右侧面板分为两个标签页：

1. **集字效果预览标签页**
   - 顶部工具栏：[◐反转] [☆轮廓] [✎擦除] [撤销] [重做]
   - 中部预览区：显示当前处理的字符效果
   - 底部信息区：当前尺寸、字符输入、操作按钮

2. **作品集字结果标签页**

- 以网格方式展示当前作品的所有集字图片
- 每个集字图片下方显示对应的汉字
- 提供搜索、筛选功能（可选）
- 支持批量操作（可选）

### 效果预览标签页详细设计

**可视化布局**：

```
+----------------------------------------------+
| [◐反转] [☆轮廓] [✎擦除] [↶撤销] [↷重做]   |  工具栏
+----------------------------------------------+
|                                              |
|                                              |
|                  预览区域                    |
|          +--------------------+              |
|          |                    |              |
|          |    处理后的字符     |              |  预览区（300×300px）
|          |                    |              |
|          |                    |              |
|          +--------------------+              |
|                                              |
|  [🔍-] [重置] [🔍+]          缩放: 100%     |  缩放控制区
+----------------------------------------------+
| 尺寸: 120×120px              角度: 0°       |  尺寸与角度信息
+----------------------------------------------+
| 字符: [   ]                                  |  字符输入
+----------------------------------------------+
| [   取消   ]                  [   保存   ]   |  操作按钮
+----------------------------------------------+
```

**工具栏**：

- 反转按钮：切换黑白反转效果
  - 未选中状态：[◐反转]（灰色）
  - 选中状态：[◐反转]（蓝色高亮）
- 轮廓按钮：显示/隐藏字符轮廓
  - 未选中状态：[☆轮廓]（灰色）
  - 选中状态：[☆轮廓]（蓝色高亮）
- 擦除按钮：激活擦除模式
  - 未选中状态：[✎擦除]（灰色）
  - 选中状态：[✎擦除]（蓝色高亮，光标变为橡皮擦图标）
- 撤销/重做按钮：
  - 可用状态：[↶撤销] [↷重做]（深色）
  - 禁用状态：[↶撤销] [↷重做]（浅灰色）

**预览区**：

- 固定容器尺寸（300×300px）白色背景区域
- 中心对齐字符，黑字白底（可通过反转切换为白字黑底）
- 处理后的二值化图像占据主要区域
- **支持缩放和平移操作**：
  - 双指捏合或缩放按钮：放大/缩小图像
  - 拖动手势：在放大状态下平移图像
  - 图像超出容器边界时显示滚动指示器
  - 双击：重置缩放和位置
- 不同状态预览：
  ```
  +----------------------+  +----------------------+  +----------------------+
  |                      |  |                      |  |                      |
  |       示例字         |  |       示例字         |  |       示例字         |
  |    (二值化效果)      |  |    (显示轮廓线)      |  |    (擦除模式下)      |
  |                      |  |                      |  |    鼠标为橡皮擦      |
  |                      |  |                      |  |                      |
  +----------------------+  +----------------------+  +----------------------+
   标准显示模式            轮廓显示模式             擦除模式
  ```

**缩放控制区**：

- 缩放减小按钮 [🔍-]：每次点击缩小10%
- 重置按钮 [重置]：恢复到100%比例并居中
- 缩放增大按钮 [🔍+]：每次点击放大10%
- 缩放比例指示器：显示当前缩放比例（如"缩放: 150%"）
- 缩放范围：50% - 300%

**信息与操作区**：

- 尺寸指示器：显示当前选框的像素尺寸和旋转角度
  - 格式：尺寸: [宽]×[高]px 角度: [角度]°
  - 编辑状态：数值可点击进行微调
- 字符输入框：
  - 单字符宽度，居中显示
  - 输入时进行验证（仅允许单个汉字）
  - 错误状态显示红色边框+提示
- 操作按钮：
  - 取消按钮：灰色背景，黑色文字
  - 保存按钮：蓝色背景，白色文字
  - 悬停状态有轻微色变和阴影效果

### 集字结果标签页详细设计

**可视化布局**：

```
+----------------------------------------------+
| 搜索: [                    ] [筛选 ▼]       |  搜索筛选区
+----------------------------------------------+
|                                              |
|  +------+  +------+  +------+  +------+     |
|  |  字  |  |  集  |  |  功  |  |  能  |     |
|  +------+  +------+  +------+  +------+     |
|                                              |  网格视图区
|  +------+  +------+  +------+  +------+     |
|  |  示  |  |  例  |  |  文  |  |  字  |     |
|  +------+  +------+  +------+  +------+     |
|                                              |
|  +------+  +------+  +------+  +------+     |
|  |  设  |  |  计  |  |  展  |  |  示  |     |
|  +------+  +------+  +------+  +------+     |
|                                              |
+----------------------------------------------+
| 显示: 1-16/34                [◀ 1 2 3... ▶] |  分页控制区
+----------------------------------------------+
```

**搜索区详细设计**：

- 搜索框：
  - 占据大部分宽度（约70%）
  - 左侧带有放大镜图标
  - 占位文本："搜索字符..."
  - 输入时实时过滤结果
- 筛选下拉菜单：
  - 点击显示筛选选项
  - 选项包括：

    ```
    +------------------+
    | 筛选 ▼           |
    +------------------+
    | ✓ 全部字符       |
    | □ 最近添加       |
    | □ 最近修改       |
    | □ 按笔画排序     |
    | □ 自定义顺序     |
    +------------------+
    ```

  - 选中选项旁显示对勾
  - 可多选组合筛选条件

**网格视图详细设计**：

- 网格布局：
  - 默认4列，根据屏幕宽度自适应（大屏可增至6列）
  - 等宽等高网格项，比例1:1
  - 内边距统一8dp
  - 网格间距均为12dp

- 单个网格项设计：

  ```
  +------------------------+
  |                        |
  |                        |  字符图片区
  |         集             |  (居中显示)
  |                        |
  |                        |
  +------------------------+
  |          集            |  字符标签
  +------------------------+
  ```

- 网格项状态：

  ```
  +--------------+  +--------------+  +--------------+
  |              |  |    ✓         |  |  ↗           |
  |     字       |  |     字       |  |     字       |
  |              |  |              |  |              |
  +--------------+  +--------------+  +--------------+
  |     字       |  |     字       |  |     字       |
  +--------------+  +--------------+  +--------------+
    普通状态         选中状态         悬停状态
  ```

- 网格项交互：
  - 悬停状态：显示浅色背景和操作图标
  - 点击：选中并跳转到对应字符
  - 右键点击：显示操作菜单

    ```
    +-------------+
    | 编辑        |
    | 复制        |
    | 删除        |
    | 导出图片... |
    +-------------+
    ```

**分页控制区详细设计**：

- 左侧信息：显示当前查看范围和总数
  - 格式："显示: [起始]-[结束]/[总数]"
- 右侧分页：
  - 最多显示5页按钮+首尾导航
  - 当前页高亮显示
  - 不可用按钮（如第一页时的上一页）显示为灰色
  - 点击页码直接跳转
  - 支持键盘左右键导航

**空状态设计**：

当没有集字结果时显示：

```
+----------------------------------------------+
|                                              |
|                                              |
|                  😊                         |
|                                              |
|            还没有收集任何字符                |
|                                              |
|         点击左侧"框选工具"开始收集           |
|                                              |
|          [开始收集]                          |
|                                              |
+----------------------------------------------+
```

**批量操作模式**：

当选中多个字符时，顶部显示批量操作栏：

```
+----------------------------------------------+
| ✓ 已选择8个字符  [导出] [删除] [取消选择]    |
+----------------------------------------------+
|                                              |
|  +------+  +------+  +------+  +------+     |
|  |✓ 字  |  |✓ 集  |  |  功  |  |  能  |     |
|  +------+  +------+  +------+  +------+     |
|                                              |
|  +------+  +------+  +------+  +------+     |
|  |✓ 示  |  |✓ 例  |  |  文  |  |  字  |     |
|  +------+  +------+  +------+  +------+     |
|                                              |
+----------------------------------------------+
```

## 界面状态变化设计

### 1. 默认状态

- 预览区显示原图，已收集字显示绿色框线
- 工具栏待选状态，拖拽工具激活
- 导航栏显示基本导航元素

### 2. 框选状态

- 框选工具激活（蓝色高亮）
- 鼠标显示为十字光标
- 拖动时显示蓝色选框
- 右侧实时显示处理效果
- 导航栏显示"框选模式"状态提示

### 3. 编辑已保存字状态

- 选中的绿色框变为蓝色
- 右侧显示该字的处理效果
- 可调整框大小和位置
- 导航栏显示"编辑模式"和字符信息

### 4. 多选状态

- 多选工具激活
- 点击选中的框线变为蓝色
- 右侧显示最后选中字的效果
- 导航栏显示已选中的字符数量

### 5. 擦除状态

- 擦除工具激活
- 右侧预览区可进行擦除操作
- 显示擦除轨迹，实时更新效果
- 导航栏显示"擦除模式"状态提示

### 6. 集字结果浏览状态

- 右侧标签页切换到"作品集字结果"
- 网格展示所有已集字图片
- 点击某个集字图片时：
  - 左侧预览区自动聚焦到该字所在位置
  - 该字区域线框变为选中状态（蓝色）
  - 右侧标签页自动切换回"集字效果预览"显示该字

## 响应式设计

界面需要适应不同屏幕尺寸，主要调整方式：

- **大屏幕**（>1200px）：左右区域比例约为 6:4
- **中等屏幕**（800-1200px）：左右区域比例约为 1:1
- **小屏幕**（<800px）：可考虑堆叠布局，上方预览区，下方效果区

## 颜色与视觉规范

- **主色调**：应用主题色（建议蓝色系）
- **工具栏**：浅灰背景，选中工具高亮显示
- **预览区**：浅色背景，突出图片内容
- **选框颜色**：
  - 新建/编辑中：蓝色（#3B82F6）
  - 已保存：绿色（#10B981）
  - 多选：蓝色（#3B82F6）
- **按钮状态**：
  - 默认：主题色
  - 禁用：灰色（#9CA3AF）
  - 激活：深主题色
  - 悬停：带有透明度的主题色

## 辅助功能设计

为了确保良好的可访问性，界面设计考虑以下因素：

- 对比度：文本与背景保持足够对比度（至少4.5:1）
- 键盘导航：支持使用Tab键在控件间导航
- 屏幕阅读器支持：为关键UI元素提供语义标签
- 自适应字体大小：支持系统字体大小调整
