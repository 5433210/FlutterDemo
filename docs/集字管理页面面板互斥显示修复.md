# 集字管理页面面板互斥显示修复

## 问题描述

在集字管理页面中，当窗口宽度不足时，筛选面板和集字详情面板会重叠，导致用户界面混乱。

## 解决方案

实现了基于窗口宽度的面板互斥显示逻辑：

### 1. 响应式断点

- **宽屏模式** (≥ 1200px): 筛选面板和详情面板可以同时显示
- **窄屏模式** (< 1200px): 筛选面板和详情面板互斥显示

### 2. 互斥逻辑

在窄屏模式下：

- 打开详情面板时，自动关闭筛选面板
- 打开筛选面板时，自动关闭详情面板
- 确保同一时间只显示一个面板

### 3. 修改的文件

#### a) 状态管理

- `character_management_state.dart`: 添加了 `isFilterOpen` 字段来跟踪筛选面板状态

#### b) Provider 逻辑

- `character_management_provider.dart`:
  - 添加了 `openDetailPanel()` 方法，包含关闭筛选面板的逻辑
  - 添加了 `openFilterPanel()` 方法，包含关闭详情面板的逻辑
  - 添加了 `toggleFilterPanel()` 方法

#### c) 用户界面

- `m3_character_browse_panel.dart`:
  - 根据屏幕宽度和详情面板状态决定是否显示筛选面板
  - 修改了 `_toggleFilterPanel()` 方法，在窄屏下实现互斥逻辑

- `m3_character_management_page.dart`:
  - 修改了 `_handleCharacterTap()` 方法，在窄屏下使用 `openDetailPanel()` 方法

### 4. 用户体验改进

#### 宽屏设备 (≥ 1200px)

- 筛选面板和详情面板可以同时显示
- 提供最大的信息展示空间
- 适合桌面端用户的多任务操作需求

#### 窄屏设备 (< 1200px)

- 面板互斥显示，避免界面重叠
- 用户可以在筛选和查看详情之间快速切换
- 适合平板电脑和较小屏幕的使用场景

### 5. 技术特点

1. **响应式设计**: 基于实际窗口宽度动态调整布局策略
2. **状态同步**: 通过 Riverpod 状态管理确保面板状态一致性
3. **用户友好**: 面板切换流畅，避免界面冲突
4. **向后兼容**: 不影响现有的面板功能和用户操作习惯

### 6. 使用方法

用户无需额外操作，系统会根据窗口大小自动调整：

- **宽屏幕**: 正常使用筛选和详情功能
- **窄屏幕**:
  - 点击字符项时自动打开详情面板（关闭筛选面板）
  - 点击筛选按钮时打开筛选面板（关闭详情面板）
  - 通过关闭详情面板可以重新显示筛选面板

这个解决方案确保了集字管理页面在各种屏幕尺寸下都能提供良好的用户体验。
