# å­—å¸–ç¼–è¾‘é¡µæ—¥å¿—ç³»ç»Ÿä½¿ç”¨ç¤ºä¾‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯¼å…¥å¿…è¦çš„åŒ…
```dart
import 'package:charasgem/infrastructure/logging/edit_page_logger_extension.dart';
import 'package:charasgem/utils/config/edit_page_logging_config.dart';
```

### 2. åº”ç”¨å¯åŠ¨æ—¶é…ç½®æ—¥å¿—ç³»ç»Ÿ
```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // æ ¹æ®ç¯å¢ƒé…ç½®æ—¥å¿—ç³»ç»Ÿ
  if (kDebugMode) {
    EditPageLoggingConfig.configureForDevelopment();
  } else {
    EditPageLoggingConfig.configureForProduction();
  }
  
  runApp(MyApp());
}
```

## ğŸ“ åŸºæœ¬ä½¿ç”¨æ–¹æ³•

### ç¼–è¾‘é¡µé¢æ—¥å¿—
```dart
class M3PracticeEditPage extends StatefulWidget {
  @override
  void initState() {
    super.initState();
    
    // é¡µé¢åˆå§‹åŒ–æ—¥å¿—
    EditPageLogger.editPageInfo('ç¼–è¾‘é¡µé¢åˆå§‹åŒ–å¼€å§‹');
    
    _initializePage();
  }
  
  void _initializePage() {
    try {
      // å…·ä½“åˆå§‹åŒ–é€»è¾‘
      _loadData();
      
      EditPageLogger.editPageInfo('ç¼–è¾‘é¡µé¢åˆå§‹åŒ–å®Œæˆ');
    } catch (e, stackTrace) {
      EditPageLogger.editPageError(
        'ç¼–è¾‘é¡µé¢åˆå§‹åŒ–å¤±è´¥', 
        error: e, 
        stackTrace: stackTrace
      );
    }
  }
  
  void _onToolChanged(String toolName) {
    EditPageLogger.editPageInfo('å·¥å…·åˆ‡æ¢', data: {
      'from_tool': _currentTool,
      'to_tool': toolName,
      'timestamp': DateTime.now().toIso8601String(),
    });
    
    _currentTool = toolName;
  }
}
```

### æ§åˆ¶å™¨æ—¥å¿—
```dart
class PracticeEditController {
  void updateElement(String elementId, Map<String, dynamic> properties) {
    EditPageLogger.controllerInfo('å…ƒç´ å±æ€§æ›´æ–°', data: {
      'element_id': elementId,
      'properties': properties,
    });
    
    try {
      // æ›´æ–°é€»è¾‘
      _applyElementUpdate(elementId, properties);
      
      EditPageLogger.controllerInfo('å…ƒç´ å±æ€§æ›´æ–°æˆåŠŸ', data: {
        'element_id': elementId,
      });
    } catch (e, stackTrace) {
      EditPageLogger.controllerError(
        'å…ƒç´ å±æ€§æ›´æ–°å¤±è´¥', 
        error: e, 
        stackTrace: stackTrace,
        data: {'element_id': elementId}
      );
    }
  }
  
  void _onDragStart(String elementId) {
    // ä½¿ç”¨è°ƒè¯•çº§åˆ«æ—¥å¿—è®°å½•æ‹–æ‹½å¼€å§‹
    if (EditPageLoggingConfig.enableControllerLogging) {
      AppLogger.debug('æ‹–æ‹½å¼€å§‹', 
          tag: EditPageLoggingConfig.TAG_CONTROLLER,
          data: {'element_id': elementId});
    }
  }
}
```

## âš¡ æ€§èƒ½ç›‘æ§ä½¿ç”¨

### ä½¿ç”¨ PerformanceTimer
```dart
class M3PracticeEditCanvas extends StatefulWidget {
  void _renderCanvas() {
    // åˆ›å»ºæ€§èƒ½è®¡æ—¶å™¨
    final timer = PerformanceTimer('ç”»å¸ƒæ¸²æŸ“', tag: EditPageLoggingConfig.TAG_CANVAS);
    
    try {
      // æ‰§è¡Œæ¸²æŸ“é€»è¾‘
      _performCanvasRender();
      
    } finally {
      // å®Œæˆè®¡æ—¶å¹¶è‡ªåŠ¨è®°å½•æ—¥å¿—
      timer.finish();
    }
  }
  
  void _complexRenderOperation() {
    final timer = PerformanceTimer('å¤æ‚æ¸²æŸ“æ“ä½œ', 
        tag: EditPageLoggingConfig.TAG_CANVAS,
        additionalData: {
          'element_count': _elements.length,
          'canvas_size': '${_canvasWidth}x${_canvasHeight}',
        });
    
    // æ‰§è¡Œå¤æ‚æ¸²æŸ“
    _doComplexRender();
    
    timer.finish();
  }
}
```

### æ‰‹åŠ¨æ€§èƒ½æ—¥å¿—
```dart
class CollectionElementRenderer {
  void renderCharacter(String character) {
    final stopwatch = Stopwatch()..start();
    
    try {
      // æ¸²æŸ“é€»è¾‘
      _doRenderCharacter(character);
      
    } finally {
      stopwatch.stop();
      final elapsedMs = stopwatch.elapsedMilliseconds;
      
      // è®°å½•æ¸²æŸ“æ€§èƒ½ï¼Œè¶…è¿‡16ms(ä¸€å¸§æ—¶é—´)ä¼šè‡ªåŠ¨è®°å½•ä¸ºè­¦å‘Š
      EditPageLogger.logPerformance('å­—ç¬¦æ¸²æŸ“', elapsedMs, 
          tag: EditPageLoggingConfig.TAG_RENDERER,
          customThreshold: 16, // è‡ªå®šä¹‰é˜ˆå€¼
          additionalData: {
            'character': character,
            'font_size': _fontSize,
          });
    }
  }
}
```

## ğŸ›ï¸ æ¡ä»¶æ—¥å¿—ä½¿ç”¨

### é«˜é¢‘æ“ä½œçš„æ¡ä»¶æ—¥å¿—
```dart
class M3PracticeEditCanvas extends StatefulWidget {
  void _onMouseMove(Offset position) {
    // é«˜é¢‘çš„é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œåªåœ¨ç”»å¸ƒæ—¥å¿—å¼€å¯æ—¶è®°å½•
    if (EditPageLoggingConfig.enableCanvasLogging) {
      AppLogger.debug('é¼ æ ‡ç§»åŠ¨', 
          tag: EditPageLoggingConfig.TAG_CANVAS,
          data: {
            'x': position.dx,
            'y': position.dy,
          });
    }
  }
  
  void _onElementDrag(String elementId, Offset delta) {
    // æ‹–æ‹½æ“ä½œçš„æ¡ä»¶æ—¥å¿—
    if (EditPageLoggingConfig.enableCanvasLogging && 
        EditPageLoggingConfig.canvasMinLevel.index <= LogLevel.debug.index) {
      AppLogger.debug('å…ƒç´ æ‹–æ‹½', 
          tag: EditPageLoggingConfig.TAG_CANVAS,
          data: {
            'element_id': elementId,
            'delta_x': delta.dx,
            'delta_y': delta.dy,
          });
    }
  }
}
```

### å±æ€§é¢æ¿çš„æ¡ä»¶æ—¥å¿—
```dart
class M3TextPropertyPanel extends StatefulWidget {
  void _onFontSizeChanged(double fontSize) {
    // å±æ€§å˜æ›´æ—¥å¿—ï¼Œé»˜è®¤å…³é—­ä»¥é¿å…æ€§èƒ½å½±å“
    if (EditPageLoggingConfig.enablePropertyPanelLogging) {
      AppLogger.info('å­—ä½“å¤§å°å˜æ›´', 
          tag: EditPageLoggingConfig.TAG_TEXT_PANEL,
          data: {
            'old_size': _currentFontSize,
            'new_size': fontSize,
          });
    }
    
    _currentFontSize = fontSize;
    _updateElement();
  }
  
  void _onTextContentChanged(String content) {
    // æ–‡æœ¬å†…å®¹å˜æ›´çš„æ‰¹é‡æ—¥å¿—å¤„ç†
    _textChangeDebouncer.run(() {
      if (EditPageLoggingConfig.enablePropertyPanelLogging) {
        AppLogger.info('æ–‡æœ¬å†…å®¹å˜æ›´', 
            tag: EditPageLoggingConfig.TAG_TEXT_PANEL,
            data: {
              'content_length': content.length,
              'has_line_breaks': content.contains('\n'),
            });
      }
    });
  }
}
```

## ğŸ”§ åŠ¨æ€é…ç½®ä½¿ç”¨

### è¿è¡Œæ—¶è°ƒæ•´æ—¥å¿—çº§åˆ«
```dart
class DebugPanel extends StatefulWidget {
  void _onPerformanceDebuggingEnabled() {
    // å¯ç”¨æ€§èƒ½è°ƒè¯•æ¨¡å¼
    EditPageLoggingConfig.configureForPerformanceDebugging();
    EditPageLogger.editPageInfo('å·²å¯ç”¨æ€§èƒ½è°ƒè¯•æ¨¡å¼');
  }
  
  void _onHighFrequencyLogsDisabled() {
    // å…³é—­é«˜é¢‘æ—¥å¿—ä»¥æå‡æ€§èƒ½
    EditPageLoggingConfig.disableHighFrequencyLogs();
    EditPageLogger.editPageInfo('å·²å…³é—­é«˜é¢‘æ—¥å¿—');
  }
  
  void _onErrorOnlyMode() {
    // ä»…è®°å½•é”™è¯¯æ—¥å¿—
    EditPageLoggingConfig.enableOnlyErrors();
    EditPageLogger.editPageInfo('å·²åˆ‡æ¢åˆ°ä»…é”™è¯¯æ¨¡å¼');
  }
}
```

### æ ¹æ®ç”¨æˆ·è®¾ç½®è°ƒæ•´
```dart
class SettingsService {
  void applyLoggingSettings(Map<String, dynamic> settings) {
    // æ ¹æ®ç”¨æˆ·åå¥½è®¾ç½®æ—¥å¿—çº§åˆ«
    final enableVerboseLogging = settings['enable_verbose_logging'] ?? false;
    final enablePerformanceMonitoring = settings['enable_performance_monitoring'] ?? true;
    
    if (enableVerboseLogging) {
      EditPageLoggingConfig.enableDebugMode();
    } else {
      EditPageLoggingConfig.configureForProduction();
    }
    
    EditPageLoggingConfig.enablePerformanceLogging = enablePerformanceMonitoring;
    
    EditPageLogger.editPageInfo('æ—¥å¿—è®¾ç½®å·²æ›´æ–°', data: settings);
  }
}
```

## ğŸš¨ é”™è¯¯å¤„ç†ç¤ºä¾‹

### æ ‡å‡†é”™è¯¯æ—¥å¿—
```dart
class FileOperations {
  Future<void> exportProject() async {
    try {
      EditPageLogger.fileOpsInfo('å¼€å§‹å¯¼å‡ºé¡¹ç›®');
      
      await _performExport();
      
      EditPageLogger.fileOpsInfo('é¡¹ç›®å¯¼å‡ºå®Œæˆ');
    } catch (e, stackTrace) {
      EditPageLogger.fileOpsError(
        'é¡¹ç›®å¯¼å‡ºå¤±è´¥', 
        error: e, 
        stackTrace: stackTrace,
        data: {
          'export_format': _exportFormat,
          'file_size': _estimatedFileSize,
        }
      );
      
      // é‡æ–°æŠ›å‡ºå¼‚å¸¸ä¾›ä¸Šå±‚å¤„ç†
      rethrow;
    }
  }
}
```

### æ¸²æŸ“é”™è¯¯å¤„ç†
```dart
class TextRenderer {
  void renderText(String text, TextStyle style) {
    try {
      final timer = PerformanceTimer('æ–‡æœ¬æ¸²æŸ“');
      
      _doRenderText(text, style);
      
      timer.finish();
    } catch (e, stackTrace) {
      // æ¸²æŸ“é”™è¯¯æ€»æ˜¯éœ€è¦è®°å½•ï¼Œå³ä½¿æ¸²æŸ“å™¨æ—¥å¿—è¢«å…³é—­
      AppLogger.error(
        'æ–‡æœ¬æ¸²æŸ“å¤±è´¥', 
        tag: EditPageLoggingConfig.TAG_RENDERER,
        error: e, 
        stackTrace: stackTrace,
        data: {
          'text_length': text.length,
          'font_family': style.fontFamily,
          'font_size': style.fontSize,
        }
      );
    }
  }
}
```

## ğŸ“Š æœ€ä½³å®è·µ

### 1. æ—¥å¿—çº§åˆ«é€‰æ‹©
```dart
// âœ… æ­£ç¡®çš„æ—¥å¿—çº§åˆ«ä½¿ç”¨
EditPageLogger.editPageError('è‡´å‘½é”™è¯¯ï¼Œå½±å“åŠŸèƒ½');     // ERROR
EditPageLogger.editPageWarning('æ½œåœ¨é—®é¢˜ï¼Œéœ€è¦æ³¨æ„');   // WARNING  
EditPageLogger.editPageInfo('é‡è¦æ“ä½œå®Œæˆ');           // INFO
EditPageLogger.editPageDebug('è°ƒè¯•ä¿¡æ¯ï¼Œå¼€å‘ä½¿ç”¨');     // DEBUG

// âŒ é”™è¯¯çš„æ—¥å¿—çº§åˆ«ä½¿ç”¨
EditPageLogger.editPageError('ç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®');        // åº”è¯¥ç”¨ INFO
EditPageLogger.editPageInfo('å†…å­˜ä¸è¶³ï¼Œå³å°†å´©æºƒ');      // åº”è¯¥ç”¨ ERROR
```

### 2. æ€§èƒ½å‹å¥½çš„æ—¥å¿—
```dart
// âœ… é«˜é¢‘æ“ä½œä½¿ç”¨æ¡ä»¶æ—¥å¿—
void _onMouseMove(Offset position) {
  if (EditPageLoggingConfig.enableCanvasLogging) {
    AppLogger.debug('é¼ æ ‡ç§»åŠ¨', data: {'position': position});
  }
}

// âŒ é«˜é¢‘æ“ä½œç›´æ¥ä½¿ç”¨æ—¥å¿—
void _onMouseMove(Offset position) {
  AppLogger.debug('é¼ æ ‡ç§»åŠ¨', data: {'position': position}); // ä¼šå½±å“æ€§èƒ½
}
```

### 3. æœ‰ç”¨çš„æ—¥å¿—æ•°æ®
```dart
// âœ… åŒ…å«æœ‰ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯
EditPageLogger.controllerError('å…ƒç´ æ›´æ–°å¤±è´¥', 
    error: e,
    data: {
      'element_id': elementId,
      'element_type': element.type,
      'update_properties': properties.keys.toList(),
      'canvas_size': '${canvasWidth}x${canvasHeight}',
    });

// âŒ ç¼ºå°‘ä¸Šä¸‹æ–‡ä¿¡æ¯
EditPageLogger.controllerError('æ›´æ–°å¤±è´¥', error: e);
```

---

*é€šè¿‡æ­£ç¡®ä½¿ç”¨è¿™ä¸ªæ—¥å¿—ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥åœ¨ä¸å½±å“æ€§èƒ½çš„å‰æä¸‹ï¼Œè·å¾—å…¨é¢çš„è°ƒè¯•ä¿¡æ¯å’Œæ€§èƒ½ç›‘æ§æ•°æ®ã€‚* 